clear

modelfun = @(b,x)(b(1).*1e12./x.^4 + b(2).*1e9./x.^3 + ...
                  b(3).*1e6./x.^2 + b(4).*1e3./x + b(5));

x1_dat = [473.15 453.15 428.15 400.15 373.15 348.15 323.15 308.15 298.15 288.15 283.15 277.15];
y1_dat = [570.87 602.59 647.90 724.92 826.86 906.15 1028.48 1098.71 1153.07 1209.71 1255.02 1304.85];

x2_dat = [279.7 279.7 280.03 288 288 291.25 292.39 292.39 292.39 295.4...
    295.4 296.95 296.95 304.02 304.02 305.35 305.35 313.14 313.37 313.37 313.99...
    323.47 324.46 324.46 330.17 333.88 333.88 333.92 333.92 333.92 344.45 344.45...
    354.62 355.28 364.23 364.23];
y2_dat = [1456.99 1447.15 1469.95 1415.12 1392.77 1365.07 1386.04 1366.09...
    1373.97 1359.44 1367.37 1332.10 1306.44 1294.45 1300.74 1294.18 1305.08...
    1278.71 1259.60 1257.61 1250.47 1203.87 1180.19 1180.19 1176.50 1129.46...
    1129.46 1153.10 1154.68 1141.03 1087.55 1100.28 1043.80 1040.98 991.77 1019.57];

beta0 = [1;1;1;1;1];
clear b beta
beta(1,:) = nlinfit(x1_dat,y1_dat,modelfun,beta0);
beta(2,:) = nlinfit(x2_dat,y2_dat,modelfun,beta0);

x_fit = linspace(0,100,100) + 273.15;
y_fit = beta(:,1).*1e12./x_fit.^4 + beta(:,2).*1e9./x_fit.^3 + ...
                  beta(:,3).*1e6./x_fit.^2 + beta(:,4).*1e3./x_fit + beta(:,5);

y_fit_a = beta(1,1).*1e12./x2_dat.^4 + beta(1,2).*1e9./x2_dat.^3 + ...
                  beta(1,3).*1e6./x2_dat.^2 + beta(1,4).*1e3./x2_dat + beta(1,5);
              
              
x = x_fit - 273.15;
figure;
% plot(x,y_fit(1,:),'-k',x1_dat-273.15,y1_dat,'ok')
% hold on
% plot(x,y_fit(2,:),'-r',x2_dat-273.15,y2_dat,'or')
% plot(x,y_fit(1,:)-y_fit(2,:),'k')
x_fit_b = x2_dat-273.15;
y_fit_b = y_fit_a-y2_dat;
plot(x_fit_b,y_fit_b,'or')
xlim([0 100])
set(gca,'FontSize',14)



